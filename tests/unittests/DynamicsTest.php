<?php

use PHPUnit\Framework\TestCase;

class  DynamicsTest extends TestCase {

    /*
     * Testing the Dynamics functions
     */

    public function test_4_4_Dynamics(){

		$dyn_data = array(
			0 => 120,
			60 => 60,
			120 => 70,
			180 => 60,
			240 => 80,
			300 => 60,
			360 => 70,
			420 => 60,
			480 => 90,
			540 => 60,
			600 => 70,
			660 => 60,
			720 => 80,
			780 => 60,
			840 => 70,
			900 => 60,
			960 => 100,
			1020 => 60,
			1080 => 70,
			1140 => 60,
			1200 => 80,
			1260 => 60,
			1320 => 70,
			1380 => 60,
			1440 => 90,
			1500 => 60,
			1560 => 70,
			1620 => 60,
			1680 => 80,
			1740 => 60,
			1800 => 70,
			1860 => 60,
			1920 => 110,
			1980 => 60,
			2040 => 70,
			2100 => 60,
			2160 => 80,
			2220 => 60,
			2280 => 70,
			2340 => 60,
			2400 => 90,
			2460 => 60,
			2520 => 70,
			2580 => 60,
			2640 => 80,
			2700 => 60,
			2760 => 70,
			2820 => 60,
			2880 => 100,
			2940 => 60,
			3000 => 70,
			3060 => 60,
			3120 => 80,
			3180 => 60,
			3240 => 70,
			3300 => 60,
			3360 => 90,
			3420 => 60,
			3480 => 70,
			3540 => 60,
			3600 => 80,
			3660 => 60,
			3720 => 70,
			3780 => 60,
			3840 => 120,
			3900 => 60,
			3960 => 70,
			4020 => 60,
			4080 => 80,
			4140 => 60,
			4200 => 70,
			4260 => 60,
			4320 => 90,
			4380 => 60,
			4440 => 70,
			4500 => 60,
			4560 => 80,
			4620 => 60,
			4680 => 70,
			4740 => 60,
			4800 => 100,
			4860 => 60,
			4920 => 70,
			4980 => 60,
			5040 => 80,
			5100 => 60,
			5160 => 70,
			5220 => 60,
			5280 => 90,
			5340 => 60,
			5400 => 70,
			5460 => 60,
			5520 => 80,
			5580 => 60,
			5640 => 70,
			5700 => 60,
			5760 => 110,
			5820 => 60,
			5880 => 70,
			5940 => 60,
			6000 => 80,
			6060 => 60,
			6120 => 70,
			6180 => 60,
			6240 => 90,
			6300 => 60,
			6360 => 70,
			6420 => 60,
			6480 => 80,
			6540 => 60,
			6600 => 70,
			6660 => 60,
			6720 => 100,
			6780 => 60,
			6840 => 70,
			6900 => 60,
			6960 => 80,
			7020 => 60,
			7080 => 70,
			7140 => 60,
			7200 => 90,
			7260 => 60,
			7320 => 70,
			7380 => 60,
			7440 => 80,
			7500 => 60,
			7560 => 70,
			7620 => 60,
			7680 => 120,
			7740 => 60,
			7800 => 70
		);

		// Test straight up 4/4
		$rhythm = new Rhythm(4, 4, 4, 4);
		$dynamics = new Dynamics($rhythm, 960 * 4, 1, 120, 30, 10);

		foreach($dyn_data AS $at => $vel)
		{
			$this->assertEquals($vel, $dynamics->getVel($at), 'Dynamics 4/4 test failed');
		}
	}

    public function test_7_8_Dynamics(){

		$dyn_data = array(
			0 => 100,
			60 => 70,
			120 => 80,
			180 => 70,
			240 => 90,
			300 => 70,
			360 => 80,
			420 => 70,
			480 => 120,
			540 => 70,
			600 => 80,
			660 => 70,
			720 => 90,
			780 => 70,
			840 => 80,
			900 => 70,
			960 => 100,
			1020 => 70,
			1080 => 80,
			1140 => 70,
			1200 => 90,
			1260 => 70,
			1320 => 80,
			1380 => 70,
			1440 => 100,
			1500 => 70,
			1560 => 80,
			1620 => 70,
			1680 => 90,
			1740 => 70,
			1800 => 80,
			1860 => 70,
			1920 => 110,
			1980 => 70,
			2040 => 80,
			2100 => 70,
			2160 => 90,
			2220 => 70,
			2280 => 80,
			2340 => 70,
			2400 => 100,
			2460 => 70,
			2520 => 80,
			2580 => 70,
			2640 => 90,
			2700 => 70,
			2760 => 80,
			2820 => 70,
			2880 => 110,
			2940 => 70,
			3000 => 80,
			3060 => 70,
			3120 => 90,
			3180 => 70,
			3240 => 80,
			3300 => 70,
			3360 => 100
		);

		// Test 7/8, & different start beat
		$rhythm = new Rhythm(3, 2, 2);
		$dynamics = new Dynamics($rhythm, 480 * 7, 2, 120, 30, 10, 7, 8);

		foreach($dyn_data AS $at => $vel)
		{
			$this->assertEquals($vel, $dynamics->getVel($at), 'Dynamics 7/8 test failed');
		}
	}
}
?>